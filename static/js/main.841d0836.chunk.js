(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{109:function(e,t,n){},137:function(e,t){},139:function(e,t){},150:function(e,t){},152:function(e,t){},257:function(e,t,n){"use strict";n.r(t);var a=n(4),r=n(12),c=n.n(r),i=n(22),u=n(2),o=n(8),s=n(102),l=n.n(s),f=(n(109),n(33)),p=n.n(f),d=400,b=200;function h(e){return v.apply(this,arguments)}function v(){return(v=Object(i.a)(c.a.mark((function e(t){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.read(t);case 2:return n=e.sent,a=n.resize(d,b),e.next=6,a.getBase64Async(p.a.MIME_PNG);case 6:return e.t0=e.sent,e.t1=function(){return console.log(n)},e.t2=function(e,t){var a=n.getPixelColor(e,t);return Object.values(p.a.intToRGBA(a))},e.abrupt("return",{src:e.t0,log:e.t1,getPixel:e.t2});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=255*Math.sqrt(3);function j(e,t){var n=e.getContext("2d");!function(e){e.width=e.width,g(e)}(e),t.forEach((function(e){!function(e,t){var n=function(e){return"rgb(".concat(e[0],", ").concat(e[1],", ").concat(e[2],", ",1,")")}(t.color,t.opacity);e.beginPath(),e.fillStyle=n,e.moveTo(-1e3,0);for(var a=-200;a<=200;a++){m(e,{x:a,y:t.evaluateAtX(a)})}e.lineTo(d,0),e.lineTo(-1e3,0),e.fill()}(n,e)}))}function m(e,t){var n=t.x,a=t.y;n+=200,e.lineTo(n,a)}function g(e){var t=e.getContext("2d");t.translate(0,b),t.scale(1,-1)}var O=[100,.01,2e-4,1e-6],M=[200,200,200];function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M;this.coefficients=O,this.color=e,this.appliedMutations=[]}w.prototype.evaluateAtX=function(e){var t=0;return this.coefficients.forEach((function(n,a){t+=Math.pow(e,a)*n})),t};var y=n(51),V=n(10),k=10;var E=[{name:"decreaseRed",isValid:function(e){return e.r-k>=0},execute:function(e){return{newValue:[e.r-k,e.g,e.b],appliedMutatation:"decreased red by ".concat(k)}}},{name:"increaseRed",isValid:function(e){return e.r+k<=255},execute:function(e){return{newValue:[e.r+k,e.g,e.b],appliedMutatation:"increased red by ".concat(k)}}},{name:"decreaseGreen",isValid:function(e){return e.g-k>=0},execute:function(e){return{newValue:[e.r,e.g-k,e.b],appliedMutatation:"decreased green by ".concat(k)}}},{name:"increaseGreen",isValid:function(e){return e.g+k<=255},execute:function(e){return{newValue:[e.r,e.g+k,e.b],appliedMutatation:"increased green by ".concat(k)}}},{name:"decreaseBlue",isValid:function(e){return e.b-k>=0},execute:function(e){return{newValue:[e.r,e.g,e.b-k],appliedMutatation:"decreased blue by ".concat(k)}}},{name:"increaseBlue",isValid:function(e){return e.b+k<=255},execute:function(e){return{newValue:[e.r,e.g,e.b+k],appliedMutatation:"increased blue by ".concat(k)}}},{name:"darken",isValid:function(e){return[e.r,e.g,e.b].every((function(e){return e-k>=0}))},execute:function(e){return{newValue:[e.r-k,e.g-k,e.b-k],appliedMutatation:"decreased all color channels by ".concat(k)}}},{name:"lighten",isValid:function(e){return[e.r,e.g,e.b].every((function(e){return e+k<=255}))},execute:function(e){return{newValue:[e.r+k,e.g+k,e.b+k],appliedMutatation:"increased all color channels by ".concat(k)}}},{name:"invert color",isValid:function(){return!0},execute:function(e){return{newValue:[255-e.r,255-e.g,255-e.b],appliedMutatation:"inverted all color channels"}}},{name:"invert red channel",isValid:function(){return!0},execute:function(e){return{newValue:[255-e.r,e.g,e.b],appliedMutatation:"inverted red channel"}}},{name:"invert green channel",isValid:function(){return!0},execute:function(e){return{newValue:[e.r,255-e.g,e.b],appliedMutatation:"inverted green channel"}}},{name:"invert blue channel",isValid:function(){return!0},execute:function(e){return{newValue:[e.r,e.g,255-e.b],appliedMutatation:"inverted blue channel"}}}],P={0:10,1:.05,2:1e-4,3:5e-7},R={0:10,1:-10,2:-1,3:-.005},B={0:400,1:10,2:1,3:.005};var S=[{name:"increase coefficient",isValid:function(e,t){return e+P[t]<=B[t]},execute:function(e,t){var n=e+P[t];return{newValue:n,appliedMutation:"increased coefficient of x ** ".concat(t," to ").concat(n)}}},{name:"decrease coefficient",isValid:function(e,t){return e-P[t]>=R[t]},execute:function(e,t){var n=e-P[t];return{newValue:n,appliedMutation:"decreased coefficient of x ** ".concat(t," to ").concat(n)}}}];function T(e,t){var n=[],a=function(e){var t=[];return E.forEach((function(n){var a=Object(u.a)(e.color,3),r={r:a[0],g:a[1],b:a[2]};if(n.isValid(r)){var c=n.execute(r),i=c.newValue,o=c.appliedMutatation,s=Object(V.cloneDeep)(e);s.color=i,s.appliedMutations.push(o),t.push(s)}})),t}(e),r=function(e){var t=e.coefficients,n=[];return t.forEach((function(t,a){var r=a;S.forEach((function(a){if(a.isValid(t,r)){var c=a.execute(t,r),i=c.newValue,u=c.appliedMutation,o=Object(V.cloneDeep)(e);o.coefficients[r]=i,o.appliedMutations.push(u),n.push(o)}}))})),n}(e);return[].concat(Object(y.a)(a),Object(y.a)(r)).forEach((function(e){n.push(t.concat(e))})),n}var A=n(103);var C=Math.round(4e3);function D(e,t){var n,a=function(e,t){var n=t.xMax,a=t.yMax;return Array.from({length:e}).map((function(){return[Math.floor(Math.random()*n),Math.floor(Math.random()*a)]}))}(C,{xMax:d,yMax:b}),r=a.map((function(e){var n=Object(u.a)(e,2),a=n[0],r=n[1];return t.getPixel(a,b-r)})),c=1/0;return a=a.map((function(e){var t=Object(u.a)(e,2);return[t[0]-200,t[1]]})),e.forEach((function(e){var t=0;a.forEach((function(n,a){var c=Object(u.a)(n,2),i=c[0],o=c[1],s=function(e,t){var n,a=t.x,r=t.y,c=Object(A.a)(e.reverse());try{for(c.s();!(n=c.n()).done;){var i=n.value;if(i.evaluateAtX(a)>=r)return i.color}}catch(u){c.e(u)}finally{c.f()}return[255,255,255]}(e,{x:i,y:o}),l=r[a];t+=Math.pow(o,10)*function(e,t){var n=Object(u.a)(e,3),a=n[0],r=n[1],c=n[2],i=Object(u.a)(t,3),o=i[0],s=i[1],l=i[2],f=function(e){return e*e};return Math.sqrt(f(a-o)+f(r-s)+f(c-l))/x}(l,s)})),(t/=a.length)<c&&(n=e,c=t)})),{bestMutant:n,approximationRatio:c}}function N(){return(N=Object(i.a)(c.a.mark((function e(t,n,a,r){var i,u,o,s,l,f,p,d,b;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[],u=new w,o=1/0,s=0,l=null;case 5:if(a.current){e.next=32;break}if(f=T(u,i),p=D(f,t),d=p.bestMutant,b=p.approximationRatio,u=d[d.length-1],!(b<o)){e.next=15;break}o=b,s=0,l=Object(V.cloneDeep)(d),e.next=26;break;case 15:if(20!==++s){e.next=26;break}if(console.log("The final polynome:",u),!(i.length>=15)){e.next=20;break}return e.abrupt("break",32);case 20:i=Object(V.cloneDeep)(l),console.log("Current polynomial count: ",i.length),console.log("Adding a new polynomial"),u=new w,s=0,o=1/0;case 26:return r(Object(V.cloneDeep)(d)),j(n,d),e.next=30,new Promise((function(e){return setTimeout(e,20)}));case 30:e.next=5;break;case 32:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var I=["https://media-cdn.tripadvisor.com/media/photo-s/14/3e/a6/7b/beach.jpg","https://i.imgur.com/8tDpnVL.png","https://i.imgur.com/K82aewd.png","https://ichef.bbci.co.uk/news/976/cpsprodpb/40F0/production/_104642661_3112ae2e-7f5b-4c8d-9fd0-a4bebcb372af.jpg","https://i.imgur.com/0xJ3awl.png","https://i.imgur.com/jZSOn8N.png"];function G(e){var t=e.setBaseImageUrl;return Object(a.jsx)("div",{children:I.map((function(e){return Object(a.jsx)("img",{onClick:function(){return t(e)},className:"selectionImage",alt:"",src:e},e)}))})}function J(e){var t=e.src;return Object(a.jsx)("img",{className:"baseimage",src:t,alt:""})}function X(e){var t=e.started,n=e.setStarted;return Object(a.jsx)("button",{id:"startButton",onClick:function(){return n(!t)},children:t?"stop":"start"})}function _(e){var t=e.canvasRef;return Object(a.jsx)("canvas",{ref:t,width:d,height:b})}function q(e){var t=e.currentPolynomials;return Object(a.jsx)("div",{className:"polynomialTexts",children:t.reverse().map((function(e,t){var n=e.coefficients.map((function(e){return Math.round(1e6*e)/1e6})),r=Object(u.a)(n,4),c=r[0],i=r[1],o=r[2],s=r[3],l="".concat(c," + ").concat(i,"x ").concat(o>0?"+ "+o+"x\xb2":"","  ").concat(s>0?"+ "+o+"x\xb3":"");return Object(a.jsx)("div",{children:l},l+t)}))})}function F(){var e=Object(o.useState)(!1),t=Object(u.a)(e,2),n=t[0],r=t[1],s=Object(o.useState)(null),l=Object(u.a)(s,2),f=l[0],p=l[1],d=Object(o.useState)(null),b=Object(u.a)(d,2),v=b[0],x=b[1],j=Object(o.useState)(null),m=Object(u.a)(j,2),O=m[0],M=m[1],w=Object(o.useRef)(null),y=w.current,V=Object(o.useRef)(!0);return Object(o.useEffect)((function(){function e(){return(e=Object(i.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=p,e.next=3,h(v);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}v&&(V.current=!0,r(!1),function(){e.apply(this,arguments)}(v))}),[v]),Object(o.useEffect)((function(){w.current&&g(w.current)}),[w]),Object(o.useEffect)((function(){V.current=!n,n&&f&&function(e,t,n,a){N.apply(this,arguments)}(f,y,V,M)}),[n,f]),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("span",{className:"helptext",children:"Pick an image to approximate"}),Object(a.jsx)(G,{setBaseImageUrl:x}),Object(a.jsx)(J,{src:null===f||void 0===f?void 0:f.src}),f&&Object(a.jsx)(X,{started:n,setStarted:r}),Object(a.jsx)(_,{canvasRef:w}),O&&Object(a.jsx)(q,{currentPolynomials:O})]})}l.a.render(Object(a.jsx)(F,{}),document.getElementById("root"))}},[[257,1,2]]]);
//# sourceMappingURL=main.841d0836.chunk.js.map